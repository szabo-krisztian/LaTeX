\newpage
\section{Vizsgakérdés}
\begin{quote}
	\textit{A differenciálegyenlet (rendszer) fogalma. Kezdetiérték-probléma (Cauchy-feladat). Egzakt egyenlet, szeparábilis egyenlet, a rakéta emelkedési idejének a kiszámítása.}
\end{quote}

\subsection{Közönséges differenciálegyenletek}
Legyen $0 < n \in \N, \, I \subset \R, \, \Omega \subset \R^n$ egy-egy nyílt intervallum. Tegyük fel, hogy az
\[
f : I \times \Omega \to \R^n
\]    
függvény folytonos, és tűzzük ki az alábbi feladat megoldását:

\begin{quote}
	határozzunk meg olyan $\varphi \in I \to \Omega$ függvényt, amelyre igazak a következő állítások:
	\begin{enumerate}
		\item $\Dp$ nyílt intervallum;
		\item $\varphi \in D$;
		\item $\varphi'(x) = f(x, \, \varphi(x)) \quad (x \in \Dp)$.
	\end{enumerate}
\end{quote}

A most megfogalmazott feladatot \textit{explicit elsőrendű közönséges differenciálegyenletnek} (röviden \textit{differenciálegyenletnek}) fogjuk nevezni, és a \textit{d.e.} rövidítéssel idézni.\\

Ha adottak a $\tau \in I, \, \xi \in \Omega$ elemek, akkor a fenti $\varphi$ függvény $1. \, 2.$ és 3. mellett tegyen eleget a
\begin{enumerate}[start=4]
	\item $\tau \in \Dp$ és $\varphi(\tau) = \xi$
\end{enumerate}
kikötésnek is. Az így "kibővített" feladatot \textit{kezdetiérték-problémának} (vagy röviden \textit{Cauchy-feladatnak}) nevezzük, és a továbbiakban minderre a \textit{k.é.p.} rövidítést fogjuk használni. Az 1., 2., 3. feltételeknek (ill. az 1., 2., 3., 4. feltételeknek) eleget tevő bármelyik $\varphi$ függvényt a \textit{d.e.} (ill. a \textit{k.é.p.}) \textit{megoldásának} nevezzük. A fenti definícióban szereplő $f$ függvény az illető \textit{d.e.} ún. \textit{jobb oldala}.

\subsection{Teljes megoldás}
Azt mondjuk, hogy a szóban forgó \textit{k.é.p. egyértelműen oldható meg}, ha tetszőleges $\varphi, \, \psi$ megoldásai esetén
\[
\varphi(x) = \psi(x) \quad (x \in \Dp \cap \mathcal{D}_\psi).
\]
(Mivel $\tau \in \Dp \cap \mathcal{D}_\psi$, ezért $\Dp \cap \mathcal{D}_\psi$ egy ($\tau$-t tartalmazó) nyílt intervallum.) Legyen ekkor $\mathcal{M}$ a szóban forgó \textit{k.é.p.} megoldásainak a halmaza és
\[
J := \bigcup_{\varphi \in \mathcal{M}} \Dp.
\]
Ez egy $\tau$-t tartalmazó nyílt intervallum és $J \subset I$. Az egyértelmű megoldhatóság értelmezése miatt definiálhatjuk a
\[
\Phi : J \to \Omega
\]
függvényt az alábbiak szerint:
\[
\Phi(x) := \varphi(x) \quad (\varphi \in \mathcal{M}, \, x \in \Dp).
\]
Nyilvánvaló, hogy $\Phi(\tau) = \xi, \, \Phi \in D$ és
\[
\Phi'(x) = f(x, \, \Phi(x)) \quad (x \in J).
\]
Ez azt jelenti, hogy $\Phi \in \mathcal{M}$, és (ld. a $\mathcal{D}_\Phi = J$ definícióját) bármelyik $\varphi \in \mathcal{M}$ esetén
\[
\varphi(x) = \Phi(x) \quad (x \in \Dp),
\]
röviden $\varphi = \Phi_{|_{\Dp}}$.\\

A $\Phi$ függvényt a kezdetiérték-probléma \textit{teljes megoldásának} nevezzük.

\subsection{Szeparábilis differenciálegyenlet}
Legyen $n := 1$, továbbá az $I, \, J \subset \R$ nyílt intervallumokkal és a
\[
g : I \to \R, \, h : J \to \R \, \backslash \, \{0\}
\]
folytonos függvényekkel
\[
f(x, \, y) := g(x) \cdot h(y) \quad ((x, \, y) \in I \times J).
\]
A $\varphi \in I \to J$ megoldásra tehát
\[
\varphi'(t) = g(t) \cdot h(\varphi(t)) \quad (t \in \Dp).
\]
Legyenek még adottak a $\tau \in I, \, \xi \in J$ számok, amikor is
\[
\tau \in \Dp, \, \varphi(\tau) = \xi
\]
(kezdetiérték-probléma).\\

\tikz \node[theorem]
{
	\textbf{Tétel.} Tetszőleges szeparábilis differenciálegyenletre vonatkozó kezdetiérték-probléma megoldható, és bármilyen $\varphi, \, \psi$ megoldásaira
	\[
	\varphi(t) = \psi(t) \quad (t \in \mathcal{D}_\p \cap \mathcal{D}_\psi).
	\]
};\\

\textbf{Bizonyítás.} Mivel a $h$ függvény sehol sem nulla, ezért egy $\varphi$ megoldásra
\[
\frac{\varphi'(t)}{h(\varphi(t))} = g(t) \quad (t \in \Dp).
\]
A $g : I \to \R$ is, és az $1 / h : J \to \R$ is egy-egy nyílt intervallumon értelmezett folytonos függvény, így léteznek a
\[
G : I \to \R, \, H : J \to \R
\]
primitív függvényeik: $G' = g$ és $H' = 1/h$. Az összetett függvény deriválásával kapcsolatos tétel szerint
\[
\frac{\varphi'(t)}{h(\varphi(t))} = (H \circ \varphi)'(t) = g(t) = G'(t) \quad (t \in \Dp),
\]
azaz
\[
(H \circ \varphi - G)'(t) = 0 \quad (t \in \Dp).
\]
Tehát (mivel a $\Dp$ is egy nyílt intervallum) van olyan $c \in \R$, hogy
\[
H(\varphi(t)) - G(t) = c \quad (t \in \Dp).
\]
Az $1/h$ függvény nyilván nem vesz fel $0$-t a $J$ intervallum egyetlen pontjában sem, így ugyanez igaz a $H'$ függvényre is. A deriváltfüggvény Darboux-tulajdonsága miatt tehát a $H'$ állandó előjelű. Következésképpen a $H$ függvény szigorúan monoton függvény, amiért invertálható. A $H^{-1}$ inverz függvény segítségével ezért azt kapjuk, hogy
\[
\varphi(t) = H^{-1}(G(t) + c) \quad (t \in \Dp).
\]
Ha $\tau \in I, \, \xi \in J$, és a $\varphi$ megoldás eleget tesz a $\varphi(\tau) = \xi$ kezdeti feltételnek is, akkor
\[
\xi = H^{-1}(G(\tau) + c),
\]
azaz
\[
c = H(\xi) - G(\tau).
\]
Így
\[
\varphi(t) = H^{-1}\big(G(t) + H(\xi) - G(\tau)\big)  \quad (t \in \Dp).
\]
Ha a $G, \, H$ helyett más primitív függvényeket választunk (legyenek ezek $\tilde{G}, \, \tilde{H}$), akkor alkalmas $\alpha, \, \beta \in \R$ konstansokkal
\[
\tilde{G} = G + \alpha, \, \tilde{H} = H + \beta,
\]
és
\[
\tilde{H}(\varphi(t)) - \tilde{G}(t) = H(\varphi(t)) - G(t) + \beta - \alpha = \tilde{c} \quad (t \in \Dp)
\]
adódik valamilyen $\tilde{c} \in \R$ konstanssal. Ezért
\[
\varphi(t) = H^{-1}(G(t) + \tilde{c} - \beta + \alpha) \quad (t \in \Dp),
\]
ahol (a $t := \tau$ helyettesítés után)
\[
H(\xi) - G(\tau) = \tilde{c} - \beta + \alpha,
\]
amiből megint csak
\[
\varphi(t) = H^{-1}(G(t) + H(\xi) - G(\tau)) \quad (t \in \Dp)
\]
következik. Ez azt jelenti, hogy a fentiekben mindegy, hogy melyik $G, \, H$ primitív függvényekből indulunk ki. Más szóval, ha a $\psi$ függvény is megoldása a vizsgált kezdetiérték-problémának, akkor
\[
\psi(t) = H^{-1}(G(t) + H(\xi) - G(\tau)) \quad (t \in \mathcal{D}_\psi).
\]
Mivel a $\Dp, \, \mathcal{D}_\psi$ értelmezési tartományok mindegyike egy-egy $\tau$-t tartalmazó nyílt intervallum, ezért $\Dp \cap \mathcal{D}_\psi$ is ilyen intervallum, és
\[
\psi(t) = \varphi(t) \quad (t \in \Dp \cap \mathcal{D}_\psi).
\]
Elegendő már csak azt belátnunk, hogy van megoldás. Tekintsük ehhez azokat a $G, \, H$ primitív függvényeket, amelyekre
\[
H(\xi) = G(\tau) = 0,
\]
és legyen
\[
F(x, \, y) := H(y) - G(x) \quad (x \in I, \, y \in J).
\]
Ekkor az
\[
F : I \times J \to \R
\]
függvényre léteznek és folytonosak a
\[
\partial_1 F(x, \, y) = -G'(x) = -g(x) \quad (x \in I, \, y \in J),
\]
\[
\partial_2 F(x, \, y) = H'(y) = \frac{1}{h(y)} \quad (x \in I, \, y \in J)
\]
parciális deriváltfüggvények. Ez azt jelenti, hogy az $F$ függvény folytonosan differenciálható,
\[
F(\tau, \, \xi) = H(\xi) - G(\tau) = 0,
\]
továbbá
\[
\partial_2 F(\tau, \, \xi) = H'(\xi) = \frac{1}{h(\xi)} \neq 0.
\]
Ezért az $F$-re alkalmazható az implicitfüggvény-tétel, miszerint alkalmas $K(\tau) \subset I, \, K(\xi) \subset J$ környezetekkel létezik az $F$ által a $(\tau, \, \xi)$ körül meghatározott
\[
\varphi : K(\tau) \to K(\xi)
\]
folytonosan differenciálható implicitfüggvény, amire $\varphi(\tau) = \xi$ és
\[
\varphi'(t) = -\frac{\partial_1 F(t, \, \varphi(t))}{\partial_2 F(t, \, \varphi(t))} = g(t) \cdot h(\varphi(t)) \quad (t \in K(\tau)).
\]
Röviden: a $\varphi$ implicitfüggvény megoldása a szóban forgó kezdetiérték-problémának.
$\hfill \blacksquare$

\subsection{Rakéta emelkedési ideje}
\textit{Egy $m$ tömegű rakétát $v_0$ kezdősebességgel függőlegesen fellövünk (függőleges hajítás). Tegyük fel, hogy a mozgás során a rakétára mindössze két erő hat: a nehézségi erő (jelöljük $\alpha$-val a nehézségi gyorsulást) és a pillanatnyi sebesség négyzetével arányos súrlódási erő (az ezzel kapcsolatos arányossági tényező legyen $\beta$). Mennyi ideig emelkedik a rakéta?}\\

Ha $v \in \R \to \R$ jelenti a sebesség-idő függvényt, akkor -- feltételezve, hogy $v \in D, \, \mathcal{D}_v$ intervallum és $0 \in \mathcal{D}_v$ -- a feladat matematikai modellje a következő (ld. a fizika Newton-féle mozgástörvényeit): adott $m, \, \alpha, \, \beta$ pozitív számok mellett olyan differenciálható $v$ függvényt keresünk, amelyre
\[
	mv'(t) = -m\alpha - \beta v^2(t) \quad (t \in \mathcal{D}_v).
\]
Világos, hogy $v(0) = v_0$. Azt a $T \in \mathcal{D}_v$ "pillanatot" kell meghatározni, amikor $v(T) = 0$.

\[
	I := J := \R, \, g(x) := - \alpha, \, h(y) := 1 + \frac{\beta y^2}{m \alpha} \quad (x, \, y \in \R)
\]
választással egy szeparábilis differenciálegyenlethez jutunk. Legyen $\tau := 0, \, \xi := v_0$, ekkor a
\[
	G(x) := \int\limits_0^x - \alpha \, dt = - \alpha x \quad (x \in \R),
\]
\[
	H(y) := \int\limits_{v_0}^y \frac{1}{1 + \frac{\beta t^2}{m \alpha}} \, dt = 
\]
\[
	\sqrt{\frac{m \alpha}{\beta}} \cdot \left( \text{arctg} \, \sqrt{\frac{\beta}{m \alpha}} \cdot y - \text{arctg} \, \sqrt{\frac{\beta}{m \alpha}} \cdot v_0 \right) \quad (y \in \R)
\]
függvények eleget tesznek az előbbi tétel bizonyításában mondottaknak. Következésképpen
\[
	H(v(t)) = G(t) \quad (t \in \mathcal{D}_v),
\]
azaz
\[
	\text{arctg} \, \left( \sqrt{\frac{\beta}{m \alpha}} \cdot v(t) \right) = - \sqrt{\frac{\beta \alpha}{m}} \cdot t + \text{arctg} \, \left( \sqrt{\frac{\beta}{m \alpha}} \cdot v_0 \right) \quad (t \in \mathcal{D}_v).
\]
A $v(T) = 0$ egyenlőségből a $t := T$ helyettesítéssel -- figyelembe véve, hogy $\text{arctg}(0) = 0$ -- az adódik, hogy
\[
	 T = \sqrt{\frac{m}{\beta \alpha}} \cdot \text{arctg}\left( \sqrt{\frac{\beta}{m \alpha}} \cdot v_0 \right).
\]

\subsection{Egzakt differenciálegyenlet}
Speciálisan legyen $n := 1$, és az $I, \, J \subset \R$ nyílt intervallumok, valamint a
\[
	g : I \times J \to \R \text{ és } h : I \times J \to \R \, \backslash \, \{0\}
\]
folytonos függvényekkel
\[
	f(x, \, y) := - \frac{g(x, \, y)}{h(x, \, y)} \quad \big( (x, \, y) \in I \times J \big).
\]
Ekkor a fenti minden $\p$ megoldásra
\[
	\p'(x) = - \frac{g(x, \, \p(x))}{h(x, \, \p(x))} \quad (x \in \Dp).
\]
Azt mondjuk, hogy az így kapott d.e. \textit{egzakt differenciálegyenlet}, ha az
\[
	I \times J \ni (x, \, y) \mapsto \big( g(x, \, y), \, h(x, \, y) \big) \in \R^2
\]
leképezésnek van primitív függvénye. Ez utóbbi követelmény azt jelenti, hogy egy alkalmas differenciálható
\[
	G : I \times J \to \R
\]
függvénnyel 
\[
	\text{grad} \, G = (\partial_1 G, \, \partial_2 G) = (g, \, h).
\]
Ha $\tau \in I, \, \xi \in J$ és a $\p$ függvénytől azt is elvárjuk, hogy
\[
	\tau \in \Dp, \, \p(\tau) = \xi,
\]
akkor igaz az\\

\tikz \node[theorem]
{
	\textbf{Tétel}. Tetszőleges egzakt differenciálegyenletre vonatkozó minden
	kezdetiérték-probléma megoldható, és ennek bármilyen $\p, \, \psi$ megoldásaira
	\[
		\p(t) = \psi(t) \quad (t \in \Dpps).
	\]
};\\

\textbf{Bizonyítás.} Valóban, $0 \not \in \mathcal{R}_h$ miatt a feltételezett $\p$ megoldásra
\[
	g(x, \, \p(x)) + h(x, \, \p(x)) \cdot \p'(x) = 0 \quad (x \in \Dp).
\]
Ha van ilyen $\p$ függvény, akkor az
\[
	F(x) := G(x, \, \p(x)) \quad (x \in \Dp)
\]
egyváltozós valós függvény differenciálható, és tetszőleges $x \in \Dp$ helyen
\[
	F'(x) = \big\langle \text{grad} \, G(x, \, \p(x)), \, (1, \, \p'(x)) \big\rangle =
\]
\[
	g(x, \, \p(x)) + h(x, \, \p(x)) \cdot \p'(x) = 0.
\]
A $\mathcal{D}_F = \Dp$ halmaz nyílt intervallum, ezért az $F$ konstans függvény, azaz létezik olyan $c \in \R$, amellyel
\[
	G(x, \, \p(x)) = c \quad (x \in \Dp).
\]
Mivel $\p(\tau) = \xi$, ezért
\[
	c = G(\tau, \, \xi).
\]
A $G$-ről feltehetjük, hogy $G(\tau, \, \xi) = 0$, ezért a szóban forgó k.é.p. $\p$ megoldása eleget tesz a 
\[
	G(x, \, \p(x)) = 0 \quad (x \in \Dp)
\]
egyenletnek.\\

Világos, hogy a $\p$ nem más, mint egy, a $G$ által meghatározott implicitfüggvény. Más szóval a szóban forgó k.é.p. minden megoldása (ha létezik) a fenti implicitfüggvény-egyenletből határozható meg.\\

Ugyanakkor a feltételek alapján $G \in C^1, \, G(\tau, \, \xi) = 0$, továbbá
\[
	\partial_2G(\tau, \, \xi) = h(\tau, \, \xi) \neq 0,
\]
ezért a $G$-re (a $(\tau, \, \xi)$ helyen) teljesülnek az implicitfüggvény-tétel feltételei. Következésképpen van olyan differenciálható
\[
	\psi \in I \to J
\]
(implicit)függvény, amelyre $\mathcal{D}_\psi \subset I$ nyílt intervallum,
\[
	\tau \in \mathcal{D}_\psi, \, G(x, \, \psi(x)) = 0 \quad (x \in \mathcal{D}_\psi), \, \psi(\tau) = \xi,
\]
és
\[
	\psi'(x) = - \frac{\partial_1G(x, \, \psi(x))}{\partial_2G(x, \, \psi(x))} = - \frac{g(x, \, \psi(x))}{h(x, \, \psi(x))} \quad (x \in \mathcal{D}_\psi).
\]
$\hfill \blacksquare$

\subsection{Multiplikátor módszer}

Az egzakt differenciálegyenlet definíciójában szereplő $\text{grad} \, G = (g, \, h)$ feltételből a
\[
	\partial_1 G = g, \, \partial_2 G = h
\]
egyenlőségek következnek. Ha $g, \, h \in D$, akkor $G \in D^2$, így a Young-tétel miatt
\[
	\partial_{12}G = \partial_2 g = \partial_{21}G = \partial_1 h,
\]
azaz ekkor a
\[
	\partial_2 g = \partial_1 h
\]
feltétel teljesülése szükséges az "egzaktsághoz".\\

Azonban, ha $g, \, h \in D$, de ez előző
\[
	\partial_2g = \partial_1 h
\]
feltétel nem teljesül, akkor esetenként alkalmas ekvivalens átalakításokkal a feladat "egzakt alakra hozható". Ezek közül az átalakítások közül az ún. \textit{multiplikátor módszer} a következőt jelenti. Tegyük fel, hogy a
\[
	\mu : I \times J \to \R
\]
differenciálható függvény (pl.) minden helyen pozitív. Ekkor a
\[
	\p'(x) = - \frac{g(x, \, \p(x))}{h(x, \, \p(x))} \quad (x \in \Dp)
\]
egyenlőség nyilván ekvivalens a
\[
	\p'(x) = - \frac{g(x, \, \p(x)) \cdot \mu(x, \, \p(x))}{h(x, \, \p(x)) \cdot \mu(x, \, \varphi(x))} \quad (x \in \Dp)
\]
egyenlőséggel, azaz a $g, \, h$ függvények "kicserélhetők" a $g\mu, \, h\mu$ függvényekre. Ekkor az egzaktságnak az előző megjegyzésben megfogalmazott szükséges feltételéhez a
\[
	\partial_2(g\mu) = g \cdot \partial_2 \mu + \mu \cdot \partial_2 g = \partial_1 (h \mu) = h \cdot \partial_1 \mu + \mu \cdot \partial_1 h
\]
egyenlőségeknek kell teljesülniük. 